<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack 打包原理初探 | 唐凯强的网络博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="webpack 是当前非常流行的前端打包工具，因而面试中会经常被问到 webpack 打包原理的问题。
本文就以打包多个本地 js 文件到一个输出文件为目的，来实现一个简易的 webpack，从而理解其工作原理。
准备材料
如今，我们都习惯使用 ES6 Module。比如，现在就有三个 js 模块
`js
// entry.js
import message ...">
    
    <link rel="preload" href="/front-end-campus/assets/css/0.styles.80bf0f19.css" as="style"><link rel="preload" href="/front-end-campus/assets/js/app.8d124e8d.js" as="script"><link rel="preload" href="/front-end-campus/assets/js/9.5bad2fb7.js" as="script"><link rel="preload" href="/front-end-campus/assets/js/3.fabd7ee7.js" as="script"><link rel="preload" href="/front-end-campus/assets/js/47.897864a9.js" as="script"><link rel="prefetch" href="/front-end-campus/assets/js/10.d7ac3963.js"><link rel="prefetch" href="/front-end-campus/assets/js/11.38204bbc.js"><link rel="prefetch" href="/front-end-campus/assets/js/12.186e9473.js"><link rel="prefetch" href="/front-end-campus/assets/js/13.4cc53e0a.js"><link rel="prefetch" href="/front-end-campus/assets/js/14.955dc099.js"><link rel="prefetch" href="/front-end-campus/assets/js/15.c71cf5b2.js"><link rel="prefetch" href="/front-end-campus/assets/js/16.f2731c3d.js"><link rel="prefetch" href="/front-end-campus/assets/js/17.717c7ce4.js"><link rel="prefetch" href="/front-end-campus/assets/js/18.12434ff4.js"><link rel="prefetch" href="/front-end-campus/assets/js/19.71aac020.js"><link rel="prefetch" href="/front-end-campus/assets/js/20.c7dd47e1.js"><link rel="prefetch" href="/front-end-campus/assets/js/21.2344c662.js"><link rel="prefetch" href="/front-end-campus/assets/js/22.5f3479ae.js"><link rel="prefetch" href="/front-end-campus/assets/js/23.5135d91c.js"><link rel="prefetch" href="/front-end-campus/assets/js/24.fea49085.js"><link rel="prefetch" href="/front-end-campus/assets/js/25.6c384894.js"><link rel="prefetch" href="/front-end-campus/assets/js/26.ff4796f0.js"><link rel="prefetch" href="/front-end-campus/assets/js/27.652211ff.js"><link rel="prefetch" href="/front-end-campus/assets/js/28.aca91560.js"><link rel="prefetch" href="/front-end-campus/assets/js/29.77f05412.js"><link rel="prefetch" href="/front-end-campus/assets/js/30.c721209e.js"><link rel="prefetch" href="/front-end-campus/assets/js/31.3d33a3de.js"><link rel="prefetch" href="/front-end-campus/assets/js/32.84d571d9.js"><link rel="prefetch" href="/front-end-campus/assets/js/33.3fed109c.js"><link rel="prefetch" href="/front-end-campus/assets/js/34.5c7292c0.js"><link rel="prefetch" href="/front-end-campus/assets/js/35.0d8d39f0.js"><link rel="prefetch" href="/front-end-campus/assets/js/36.303d775c.js"><link rel="prefetch" href="/front-end-campus/assets/js/37.a709826b.js"><link rel="prefetch" href="/front-end-campus/assets/js/38.ed93fdbe.js"><link rel="prefetch" href="/front-end-campus/assets/js/39.e975a5c3.js"><link rel="prefetch" href="/front-end-campus/assets/js/4.c2a0d988.js"><link rel="prefetch" href="/front-end-campus/assets/js/40.3e36b6d7.js"><link rel="prefetch" href="/front-end-campus/assets/js/41.db2dfd14.js"><link rel="prefetch" href="/front-end-campus/assets/js/42.1c7250a0.js"><link rel="prefetch" href="/front-end-campus/assets/js/43.59b9b367.js"><link rel="prefetch" href="/front-end-campus/assets/js/44.978ef025.js"><link rel="prefetch" href="/front-end-campus/assets/js/45.b55f7b56.js"><link rel="prefetch" href="/front-end-campus/assets/js/46.533c6a8b.js"><link rel="prefetch" href="/front-end-campus/assets/js/48.90560d80.js"><link rel="prefetch" href="/front-end-campus/assets/js/49.cf430b80.js"><link rel="prefetch" href="/front-end-campus/assets/js/5.fb36ee10.js"><link rel="prefetch" href="/front-end-campus/assets/js/50.c5e0cf8f.js"><link rel="prefetch" href="/front-end-campus/assets/js/51.cf920cdb.js"><link rel="prefetch" href="/front-end-campus/assets/js/52.04618119.js"><link rel="prefetch" href="/front-end-campus/assets/js/53.c426ce22.js"><link rel="prefetch" href="/front-end-campus/assets/js/54.e1ea43b7.js"><link rel="prefetch" href="/front-end-campus/assets/js/55.6985cefc.js"><link rel="prefetch" href="/front-end-campus/assets/js/56.c160ea18.js"><link rel="prefetch" href="/front-end-campus/assets/js/57.79ce2a36.js"><link rel="prefetch" href="/front-end-campus/assets/js/58.7c94f76b.js"><link rel="prefetch" href="/front-end-campus/assets/js/6.04be791f.js"><link rel="prefetch" href="/front-end-campus/assets/js/7.a6fee5c8.js"><link rel="prefetch" href="/front-end-campus/assets/js/8.c4094294.js"><link rel="prefetch" href="/front-end-campus/assets/js/vuejs-paginate.7557bdc0.js">
    <link rel="stylesheet" href="/front-end-campus/assets/css/0.styles.80bf0f19.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/front-end-campus/" class="nav-link home-link">唐凯强的网络博客 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/front-end-campus/" class="nav-link">博客</a></li><li class="nav-item"><a href="/front-end-campus/tag/" class="nav-link">标签</a></li><li class="nav-item"><a href="/front-end-campus/2020/10/19/projects/" class="nav-link">收藏</a></li><li class="nav-item"><a href="/front-end-campus/2022/10/08/nav/" class="nav-link">导航</a></li><li class="nav-item"><a href="https://github.com/tkiddo/front-end-campus" target="_blank" rel="noopener noreferrer" class="nav-link external">Github</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/front-end-campus/" class="nav-link mobile-home-link">唐凯强的网络博客 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/front-end-campus/" class="nav-link">博客</a></li><li class="mobile-nav-item"><a href="/front-end-campus/tag/" class="nav-link">标签</a></li><li class="mobile-nav-item"><a href="/front-end-campus/2020/10/19/projects/" class="nav-link">收藏</a></li><li class="mobile-nav-item"><a href="/front-end-campus/2022/10/08/nav/" class="nav-link">导航</a></li><li class="mobile-nav-item"><a href="https://github.com/tkiddo/front-end-campus" target="_blank" rel="noopener noreferrer" class="nav-link external">Github</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        webpack 打包原理初探
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2021-01-13T00:00:00.000Z">
      Wed Jan 13 2021
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/front-end-campus/tag/Webpack" data-v-42ccfcd5><span data-v-42ccfcd5>Webpack</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p>webpack 是当前非常流行的前端打包工具，因而面试中会经常被问到 webpack 打包原理的问题。</p> <p>本文就以打包多个本地 js 文件到一个输出文件为目的，来实现一个简易的 webpack，从而理解其工作原理。</p> <h2 id="准备材料"><a href="#准备材料" class="header-anchor">#</a> 准备材料</h2> <p>如今，我们都习惯使用 ES6 Module。比如，现在就有三个 js 模块</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// entry.js</span>
<span class="token keyword">import</span> message <span class="token keyword">from</span> <span class="token string">'./message.js'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//message.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./name.js'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">//name.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'world'</span><span class="token punctuation">;</span>
</code></pre></div><p>我们要做的，就是将者三个 js 模块打包到一个 js 中。</p> <h2 id="从-commonjs-说起"><a href="#从-commonjs-说起" class="header-anchor">#</a> 从 CommonJS 说起</h2> <p>我们知道，服务器端的 Node.js 遵循 CommonJS 规范，该规范的核心思想是允许模块通过 require 方法来同步加载所要依赖的其他模块，然后通过 exports 或 module.exports 来导出需要暴露的接口。而浏览器不兼容 CommonJS 的根本原因，就在于缺少 require，exports 以及 module 这三个变量（global 在浏览器中对应 window）。</p> <p>比如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'a'</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  name
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// index.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>require</code>的原理也很简单，就是解析文件路径，读取内容，然后将暴露（exports 或者 module.exports）的接口返回</p> <p>简单实现<code>require</code>即：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">localrequire</span><span class="token punctuation">(</span><span class="token parameter">relativePath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dirname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>relativePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">eval</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token punctuation">{</span> exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">fn</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> localrequire<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果你看过 webpack 打包后输出的文件，就会发现有这么一段：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// The require function</span>
<span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Check if module is in cache</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>__webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> __webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Create a new module (and put it into the cache)</span>
  <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">(</span>__webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// no module.id needed</span>
    <span class="token comment">// no module.loaded needed</span>
    exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Execute the module function</span>
  __webpack_modules__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Return the exports of the module</span>
  <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>webpack 正是提供了这三个变量来实现了 CommonJS 模块。</p> <h2 id="分析模块"><a href="#分析模块" class="header-anchor">#</a> 分析模块</h2> <p>从模块中导入模块的语句可以找到当前模块的依赖，比如<code>import message from './message.js';</code>，但是这种做法不灵活，更好的办法是使用 JavaScript 解析器。</p> <p>JavaScript 解析器的作用是读取模块内容，并将其转化为 AST，即<a href="https://baike.baidu.com/item/%E6%8A%BD%E8%B1%A1%E8%AF%AD%E6%B3%95%E6%A0%91/6129952" target="_blank" rel="noopener noreferrer">抽象语法树<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>比如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// entry.js</span>
<span class="token keyword">import</span> message <span class="token keyword">from</span> <span class="token string">'./message.js'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>转化成 AST，是这样的：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Program&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">66</span><span class="token punctuation">,</span>
  <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ImportDeclaration&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
      <span class="token property">&quot;specifiers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ImportSpecifier&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
          <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
          <span class="token property">&quot;imported&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;local&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Literal&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
        <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./name.js&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token string">&quot;'./name.js'&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ExportDefaultDeclaration&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">33</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">65</span><span class="token punctuation">,</span>
      <span class="token property">&quot;declaration&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TemplateLiteral&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">48</span><span class="token punctuation">,</span>
        <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">,</span>
        <span class="token property">&quot;expressions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">57</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;quasis&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TemplateElement&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">49</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">55</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hello &quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;cooked&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hello &quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;tail&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TemplateElement&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token number">62</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end&quot;</span><span class="token operator">:</span> <span class="token number">63</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token string">&quot;!&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;cooked&quot;</span><span class="token operator">:</span> <span class="token string">&quot;!&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;tail&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><a href="https://astexplorer.net/" target="_blank" rel="noopener noreferrer">AST explorer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是一个在线转化 AST 的网站，你可以很方便地看到代码对应的 AST</p></blockquote> <p>其中<code>&quot;type&quot;: &quot;ImportDeclaration&quot;,</code>的子节点，就是模块引入的声明，以此来分析模块依赖更为方便。</p> <p><a href="https://babel.docschina.org/docs/en/" target="_blank" rel="noopener noreferrer">babel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>为我们提供了一系列工具来做这些事情。</p> <p>我们使用<code>@babel/parser</code>作为 JavaScript 解析器，使用<code>@babel/traverse</code>来对 AST 进行操作，使用<code>@babel/core</code>中的<code>transformFromAst</code>方法来转译代码</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> @babel/parser @babel/traverse @babel/core @babel/preset-env --save
</code></pre></div><blockquote><p>我们用到的一些高级的 JS 特性，可能不能适配所有浏览器，因此需要 babel 转译，<code>@babel/preset-env</code>是一个智能预设，帮助我们按照所需环境转译代码</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token constant">ID</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">// 该函数以文件名（包含路径）为参数，返回资源对象</span>
<span class="token keyword">function</span> <span class="token function">createAsset</span><span class="token punctuation">(</span><span class="token parameter">filename</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 读取文件内容</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 根据文件内容生成AST</span>
  <span class="token keyword">const</span> ast <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token punctuation">{</span> sourceType<span class="token operator">:</span> <span class="token string">'module'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 保存依赖</span>
  <span class="token keyword">const</span> dependencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">traverse</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">ImportDeclaration</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> node <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 将依赖的值，也就是文件名添加到数组中</span>
      dependencies<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 转译代码</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">transformFromAst</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 自增id代表模块资源的唯一标识</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token constant">ID</span><span class="token operator">++</span><span class="token punctuation">;</span>

  <span class="token comment">// 分析模块得到一个资源对象，包含id，文件名，转移后的代码以及依赖</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> id<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> code<span class="token punctuation">,</span> dependencies <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="创建模块依赖图"><a href="#创建模块依赖图" class="header-anchor">#</a> 创建模块依赖图</h2> <p>以上函数只是对单一的模块进行分析，我们将从入口文件开始，对其进行模块分析，然后再对其依赖模块进行分析，直到项目中所有模块都分析完，最后得到一个模块之间相互依赖的关系网，也可以叫做模块依赖图。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//这个函数用于从入口文件开始分析，生成依赖图</span>
<span class="token keyword">function</span> <span class="token function">createGraph</span><span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 从入口文件开始</span>
  <span class="token keyword">const</span> entryAsset <span class="token operator">=</span> <span class="token function">createAsset</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 我们使用一个队列来依次分析模块，刚开始队列中只有一个模块</span>
  <span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token punctuation">[</span>entryAsset<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// 遍历队列中的模块，刚开始只有一个模块，随后会添加进新的模块，然后继续遍历，直到剩余为空</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> asset <span class="token keyword">of</span> queue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 模块的依赖</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> dependencies <span class="token punctuation">}</span> <span class="token operator">=</span> asset<span class="token punctuation">;</span>

    <span class="token comment">// 这个对象用于保存依赖的模块名字于id的映射关系，便于追踪</span>
    asset<span class="token punctuation">.</span>mapping <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 因为本地模块的依赖是相对于当前模块导入的，这步是得到当前模块的目录</span>
    <span class="token keyword">const</span> dirname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>asset<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 遍历模块的依赖</span>
    dependencies<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">relativePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 结合当前模块目录和依赖相对路径得到依赖的绝对路径</span>
      <span class="token keyword">const</span> absolutePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 创建依赖的资源对象</span>
      <span class="token keyword">const</span> child <span class="token operator">=</span> <span class="token function">createAsset</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 将依赖对象的id添加到mapping对象上，方便后期查找</span>
      asset<span class="token punctuation">.</span>mapping<span class="token punctuation">[</span>relativePath<span class="token punctuation">]</span> <span class="token operator">=</span> child<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

      <span class="token comment">// 最后，将依赖资源对象加入到队列中。</span>
      queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> queue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="合并"><a href="#合并" class="header-anchor">#</a> 合并</h2> <p>我们可以看一下生成的模块依赖图</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'../example/entry.js'</span><span class="token punctuation">,</span>
    code<span class="token operator">:</span>
      <span class="token string">'&quot;use strict&quot;;\n'</span> <span class="token operator">+</span>
      <span class="token string">'\n'</span> <span class="token operator">+</span>
      <span class="token string">'var _message = _interopRequireDefault(require(&quot;./message.js&quot;));\n'</span> <span class="token operator">+</span>
      <span class="token string">'\n'</span> <span class="token operator">+</span>
      <span class="token string">'function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { &quot;default&quot;: obj }; }\n'</span> <span class="token operator">+</span>
      <span class="token string">'\n'</span> <span class="token operator">+</span>
      <span class="token string">'console.log(_message[&quot;default&quot;]);'</span><span class="token punctuation">,</span>
    dependencies<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./message.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    mapping<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">'./message.js'</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'..\\example\\message.js'</span><span class="token punctuation">,</span>
    code<span class="token operator">:</span>
      <span class="token string">'&quot;use strict&quot;;\n'</span> <span class="token operator">+</span>
      <span class="token string">'\n'</span> <span class="token operator">+</span>
      <span class="token string">'Object.defineProperty(exports, &quot;__esModule&quot;, {\n'</span> <span class="token operator">+</span>
      <span class="token string">'  value: true\n'</span> <span class="token operator">+</span>
      <span class="token string">'});\n'</span> <span class="token operator">+</span>
      <span class="token string">'exports[&quot;default&quot;] = void 0;\n'</span> <span class="token operator">+</span>
      <span class="token string">'\n'</span> <span class="token operator">+</span>
      <span class="token string">'var _name = require(&quot;./name.js&quot;);\n'</span> <span class="token operator">+</span>
      <span class="token string">'\n'</span> <span class="token operator">+</span>
      <span class="token string">'var _default = &quot;hello &quot;.concat(_name.name, &quot;!&quot;);\n'</span> <span class="token operator">+</span>
      <span class="token string">'\n'</span> <span class="token operator">+</span>
      <span class="token string">'exports[&quot;default&quot;] = _default;'</span><span class="token punctuation">,</span>
    dependencies<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./name.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    mapping<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">'./name.js'</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'..\\example\\name.js'</span><span class="token punctuation">,</span>
    code<span class="token operator">:</span>
      <span class="token string">'&quot;use strict&quot;;\n'</span> <span class="token operator">+</span>
      <span class="token string">'\n'</span> <span class="token operator">+</span>
      <span class="token string">'Object.defineProperty(exports, &quot;__esModule&quot;, {\n'</span> <span class="token operator">+</span>
      <span class="token string">'  value: true\n'</span> <span class="token operator">+</span>
      <span class="token string">'});\n'</span> <span class="token operator">+</span>
      <span class="token string">'exports.name = void 0;\n'</span> <span class="token operator">+</span>
      <span class="token string">&quot;var name = 'world';\n&quot;</span> <span class="token operator">+</span>
      <span class="token string">'exports.name = name;'</span><span class="token punctuation">,</span>
    dependencies<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    mapping<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>我们可以看到，id 为 0 的模块是入口模块，依赖模块<code>./message.js</code>的 id 为 1，然后根据 id 又可以找到数组中第二个模块，这是<code>mapping</code>对象的作用。</p> <p>合并后的文件只包含一个立即执行函数<code>(function() {})()</code>，按照 CommonJS 规范，并在其中实现 require 函数，提供 module，module.exports 对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 根据依赖图生成合并文件内容</span>
<span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> modules <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

  <span class="token comment">// 拼接模块字符串，将模块转译后代码包含在函数中，做到变量隔离</span>
  graph<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    modules <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:[
      function(require,module,exports){
        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      },
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>mapping<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    ],
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// require函数的作用是根据模块id得到模块的导出对象（即module.exports）</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  (function(modules){
    function require(id){
      // 第一个是模块代码，第二个是模块依赖
      const [fn,mapping] = modules[id];

      function localRequire(name){
        return require(mapping[name]);
      }

      const module = { exports:{} };

      fn(localRequire,module,module.exports);

      // 将模块接口暴露出去
      return module.exports;
    }
    require(0);
  })({</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>modules<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">})
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样，我们就完成了多个模块合并到一个 js 文件中。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token function">createGraph</span><span class="token punctuation">(</span><span class="token string">'./entry.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">bundle</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这也就是 webpack 最基本的功能实现，当然，webpack 要复杂的多。</p> <p>参考：<a href="https://github.com/ronami/minipack" target="_blank" rel="noopener noreferrer">minipack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#准备材料" title="准备材料">准备材料</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#从-commonjs-说起" title="从 CommonJS 说起">从 CommonJS 说起</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#分析模块" title="分析模块">分析模块</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#创建模块依赖图" title="创建模块依赖图">创建模块依赖图</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#合并" title="合并">合并</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/front-end-campus/assets/js/app.8d124e8d.js" defer></script><script src="/front-end-campus/assets/js/9.5bad2fb7.js" defer></script><script src="/front-end-campus/assets/js/3.fabd7ee7.js" defer></script><script src="/front-end-campus/assets/js/47.897864a9.js" defer></script>
  </body>
</html>
